### model
model_name_or_path: /gemini/data-2/Llama-2-70b-chat-hf
quantization_bit: 4

### method
stage: dpo
do_train: true
finetuning_type: lora
lora_target: layers.2.self_attn.k_proj,layers.2.self_attn.q_proj,layers.2.self_attn.v_proj,layers.2.self_attn.o_proj,layers.2.mlp.gate_proj,layers.2.mlp.up_proj,layers.2.mlp.down_proj,layers.3.self_attn.k_proj,layers.3.self_attn.q_proj,layers.3.self_attn.v_proj,layers.3.self_attn.o_proj,layers.3.mlp.gate_proj,layers.3.mlp.up_proj,layers.3.mlp.down_proj,layers.4.self_attn.k_proj,layers.4.self_attn.q_proj,layers.4.self_attn.v_proj,layers.4.self_attn.o_proj,layers.4.mlp.gate_proj,layers.4.mlp.up_proj,layers.4.mlp.down_proj,layers.5.self_attn.k_proj,layers.5.self_attn.q_proj,layers.5.self_attn.v_proj,layers.5.self_attn.o_proj,layers.5.mlp.gate_proj,layers.5.mlp.up_proj,layers.5.mlp.down_proj,layers.6.self_attn.k_proj,layers.6.self_attn.q_proj,layers.6.self_attn.v_proj,layers.6.self_attn.o_proj,layers.6.mlp.gate_proj,layers.6.mlp.up_proj,layers.6.mlp.down_proj,layers.7.self_attn.k_proj,layers.7.self_attn.q_proj,layers.7.self_attn.v_proj,layers.7.self_attn.o_proj,layers.7.mlp.gate_proj,layers.7.mlp.up_proj,layers.7.mlp.down_proj,layers.8.self_attn.k_proj,layers.8.self_attn.q_proj,layers.8.self_attn.v_proj,layers.8.self_attn.o_proj,layers.8.mlp.gate_proj,layers.8.mlp.up_proj,layers.8.mlp.down_proj,layers.9.self_attn.k_proj,layers.9.self_attn.q_proj,layers.9.self_attn.v_proj,layers.9.self_attn.o_proj,layers.9.mlp.gate_proj,layers.9.mlp.up_proj,layers.9.mlp.down_proj,layers.10.self_attn.k_proj,layers.10.self_attn.q_proj,layers.10.self_attn.v_proj,layers.10.self_attn.o_proj,layers.10.mlp.gate_proj,layers.10.mlp.up_proj,layers.10.mlp.down_proj,layers.11.self_attn.k_proj,layers.11.self_attn.q_proj,layers.11.self_attn.v_proj,layers.11.self_attn.o_proj,layers.11.mlp.gate_proj,layers.11.mlp.up_proj,layers.11.mlp.down_proj,layers.12.self_attn.k_proj,layers.12.self_attn.q_proj,layers.12.self_attn.v_proj,layers.12.self_attn.o_proj,layers.12.mlp.gate_proj,layers.12.mlp.up_proj,layers.12.mlp.down_proj,layers.13.self_attn.k_proj,layers.13.self_attn.q_proj,layers.13.self_attn.v_proj,layers.13.self_attn.o_proj,layers.13.mlp.gate_proj,layers.13.mlp.up_proj,layers.13.mlp.down_proj,layers.14.self_attn.k_proj,layers.14.self_attn.q_proj,layers.14.self_attn.v_proj,layers.14.self_attn.o_proj,layers.14.mlp.gate_proj,layers.14.mlp.up_proj,layers.14.mlp.down_proj,layers.15.self_attn.k_proj,layers.15.self_attn.q_proj,layers.15.self_attn.v_proj,layers.15.self_attn.o_proj,layers.15.mlp.gate_proj,layers.15.mlp.up_proj,layers.15.mlp.down_proj,layers.16.self_attn.k_proj,layers.16.self_attn.q_proj,layers.16.self_attn.v_proj,layers.16.self_attn.o_proj,layers.16.mlp.gate_proj,layers.16.mlp.up_proj,layers.16.mlp.down_proj,layers.17.self_attn.k_proj,layers.17.self_attn.q_proj,layers.17.self_attn.v_proj,layers.17.self_attn.o_proj,layers.17.mlp.gate_proj,layers.17.mlp.up_proj,layers.17.mlp.down_proj,layers.18.self_attn.k_proj,layers.18.self_attn.q_proj,layers.18.self_attn.v_proj,layers.18.self_attn.o_proj,layers.18.mlp.gate_proj,layers.18.mlp.up_proj,layers.18.mlp.down_proj,layers.19.self_attn.k_proj,layers.19.self_attn.q_proj,layers.19.self_attn.v_proj,layers.19.self_attn.o_proj,layers.19.mlp.gate_proj,layers.19.mlp.up_proj,layers.19.mlp.down_proj,layers.20.self_attn.k_proj,layers.20.self_attn.q_proj,layers.20.self_attn.v_proj,layers.20.self_attn.o_proj,layers.20.mlp.gate_proj,layers.20.mlp.up_proj,layers.20.mlp.down_proj,layers.21.self_attn.k_proj,layers.21.self_attn.q_proj,layers.21.self_attn.v_proj,layers.21.self_attn.o_proj,layers.21.mlp.gate_proj,layers.21.mlp.up_proj,layers.21.mlp.down_proj,layers.22.self_attn.k_proj,layers.22.self_attn.q_proj,layers.22.self_attn.v_proj,layers.22.self_attn.o_proj,layers.22.mlp.gate_proj,layers.22.mlp.up_proj,layers.22.mlp.down_proj,layers.23.self_attn.k_proj,layers.23.self_attn.q_proj,layers.23.self_attn.v_proj,layers.23.self_attn.o_proj,layers.23.mlp.gate_proj,layers.23.mlp.up_proj,layers.23.mlp.down_proj,layers.24.self_attn.k_proj,layers.24.self_attn.q_proj,layers.24.self_attn.v_proj,layers.24.self_attn.o_proj,layers.24.mlp.gate_proj,layers.24.mlp.up_proj,layers.24.mlp.down_proj,layers.25.self_attn.k_proj,layers.25.self_attn.q_proj,layers.25.self_attn.v_proj,layers.25.self_attn.o_proj,layers.25.mlp.gate_proj,layers.25.mlp.up_proj,layers.25.mlp.down_proj,layers.26.self_attn.k_proj,layers.26.self_attn.q_proj,layers.26.self_attn.v_proj,layers.26.self_attn.o_proj,layers.26.mlp.gate_proj,layers.26.mlp.up_proj,layers.26.mlp.down_proj,layers.27.self_attn.k_proj,layers.27.self_attn.q_proj,layers.27.self_attn.v_proj,layers.27.self_attn.o_proj,layers.27.mlp.gate_proj,layers.27.mlp.up_proj,layers.27.mlp.down_proj,layers.28.self_attn.k_proj,layers.28.self_attn.q_proj,layers.28.self_attn.v_proj,layers.28.self_attn.o_proj,layers.28.mlp.gate_proj,layers.28.mlp.up_proj,layers.28.mlp.down_proj,layers.29.self_attn.k_proj,layers.29.self_attn.q_proj,layers.29.self_attn.v_proj,layers.29.self_attn.o_proj,layers.29.mlp.gate_proj,layers.29.mlp.up_proj,layers.29.mlp.down_proj,layers.30.self_attn.k_proj,layers.30.self_attn.q_proj,layers.30.self_attn.v_proj,layers.30.self_attn.o_proj,layers.30.mlp.gate_proj,layers.30.mlp.up_proj,layers.30.mlp.down_proj,layers.31.self_attn.k_proj,layers.31.self_attn.q_proj,layers.31.self_attn.v_proj,layers.31.self_attn.o_proj,layers.31.mlp.gate_proj,layers.31.mlp.up_proj,layers.31.mlp.down_proj,layers.32.self_attn.k_proj,layers.32.self_attn.q_proj,layers.32.self_attn.v_proj,layers.32.self_attn.o_proj,layers.32.mlp.gate_proj,layers.32.mlp.up_proj,layers.32.mlp.down_proj,layers.33.self_attn.k_proj,layers.33.self_attn.q_proj,layers.33.self_attn.v_proj,layers.33.self_attn.o_proj,layers.33.mlp.gate_proj,layers.33.mlp.up_proj,layers.33.mlp.down_proj,layers.34.self_attn.k_proj,layers.34.self_attn.q_proj,layers.34.self_attn.v_proj,layers.34.self_attn.o_proj,layers.34.mlp.gate_proj,layers.34.mlp.up_proj,layers.34.mlp.down_proj,layers.35.self_attn.k_proj,layers.35.self_attn.q_proj,layers.35.self_attn.v_proj,layers.35.self_attn.o_proj,layers.35.mlp.gate_proj,layers.35.mlp.up_proj,layers.35.mlp.down_proj,layers.36.self_attn.k_proj,layers.36.self_attn.q_proj,layers.36.self_attn.v_proj,layers.36.self_attn.o_proj,layers.36.mlp.gate_proj,layers.36.mlp.up_proj,layers.36.mlp.down_proj,layers.37.self_attn.k_proj,layers.37.self_attn.q_proj,layers.37.self_attn.v_proj,layers.37.self_attn.o_proj,layers.37.mlp.gate_proj,layers.37.mlp.up_proj,layers.37.mlp.down_proj,layers.38.self_attn.k_proj,layers.38.self_attn.q_proj,layers.38.self_attn.v_proj,layers.38.self_attn.o_proj,layers.38.mlp.gate_proj,layers.38.mlp.up_proj,layers.38.mlp.down_proj,layers.39.self_attn.k_proj,layers.39.self_attn.q_proj,layers.39.self_attn.v_proj,layers.39.self_attn.o_proj,layers.39.mlp.gate_proj,layers.39.mlp.up_proj,layers.39.mlp.down_proj,layers.40.self_attn.k_proj,layers.40.self_attn.q_proj,layers.40.self_attn.v_proj,layers.40.self_attn.o_proj,layers.40.mlp.gate_proj,layers.40.mlp.up_proj,layers.40.mlp.down_proj,layers.41.self_attn.k_proj,layers.41.self_attn.q_proj,layers.41.self_attn.v_proj,layers.41.self_attn.o_proj,layers.41.mlp.gate_proj,layers.41.mlp.up_proj,layers.41.mlp.down_proj,layers.42.self_attn.k_proj,layers.42.self_attn.q_proj,layers.42.self_attn.v_proj,layers.42.self_attn.o_proj,layers.42.mlp.gate_proj,layers.42.mlp.up_proj,layers.42.mlp.down_proj,layers.43.self_attn.k_proj,layers.43.self_attn.q_proj,layers.43.self_attn.v_proj,layers.43.self_attn.o_proj,layers.43.mlp.gate_proj,layers.43.mlp.up_proj,layers.43.mlp.down_proj,layers.44.self_attn.k_proj,layers.44.self_attn.q_proj,layers.44.self_attn.v_proj,layers.44.self_attn.o_proj,layers.44.mlp.gate_proj,layers.44.mlp.up_proj,layers.44.mlp.down_proj,layers.45.self_attn.k_proj,layers.45.self_attn.q_proj,layers.45.self_attn.v_proj,layers.45.self_attn.o_proj,layers.45.mlp.gate_proj,layers.45.mlp.up_proj,layers.45.mlp.down_proj,layers.46.self_attn.k_proj,layers.46.self_attn.q_proj,layers.46.self_attn.v_proj,layers.46.self_attn.o_proj,layers.46.mlp.gate_proj,layers.46.mlp.up_proj,layers.46.mlp.down_proj,layers.47.self_attn.k_proj,layers.47.self_attn.q_proj,layers.47.self_attn.v_proj,layers.47.self_attn.o_proj,layers.47.mlp.gate_proj,layers.47.mlp.up_proj,layers.47.mlp.down_proj,layers.48.self_attn.k_proj,layers.48.self_attn.q_proj,layers.48.self_attn.v_proj,layers.48.self_attn.o_proj,layers.48.mlp.gate_proj,layers.48.mlp.up_proj,layers.48.mlp.down_proj,layers.49.self_attn.k_proj,layers.49.self_attn.q_proj,layers.49.self_attn.v_proj,layers.49.self_attn.o_proj,layers.49.mlp.gate_proj,layers.49.mlp.up_proj,layers.49.mlp.down_proj,layers.50.self_attn.k_proj,layers.50.self_attn.q_proj,layers.50.self_attn.v_proj,layers.50.self_attn.o_proj,layers.50.mlp.gate_proj,layers.50.mlp.up_proj,layers.50.mlp.down_proj,layers.51.self_attn.k_proj,layers.51.self_attn.q_proj,layers.51.self_attn.v_proj,layers.51.self_attn.o_proj,layers.51.mlp.gate_proj,layers.51.mlp.up_proj,layers.51.mlp.down_proj,layers.52.self_attn.k_proj,layers.52.self_attn.q_proj,layers.52.self_attn.v_proj,layers.52.self_attn.o_proj,layers.52.mlp.gate_proj,layers.52.mlp.up_proj,layers.52.mlp.down_proj,layers.53.self_attn.k_proj,layers.53.self_attn.q_proj,layers.53.self_attn.v_proj,layers.53.self_attn.o_proj,layers.53.mlp.gate_proj,layers.53.mlp.up_proj,layers.53.mlp.down_proj,layers.54.self_attn.k_proj,layers.54.self_attn.q_proj,layers.54.self_attn.v_proj,layers.54.self_attn.o_proj,layers.54.mlp.gate_proj,layers.54.mlp.up_proj,layers.54.mlp.down_proj,layers.55.self_attn.k_proj,layers.55.self_attn.q_proj,layers.55.self_attn.v_proj,layers.55.self_attn.o_proj,layers.55.mlp.gate_proj,layers.55.mlp.up_proj,layers.55.mlp.down_proj,layers.56.self_attn.k_proj,layers.56.self_attn.q_proj,layers.56.self_attn.v_proj,layers.56.self_attn.o_proj,layers.56.mlp.gate_proj,layers.56.mlp.up_proj,layers.56.mlp.down_proj,layers.57.self_attn.k_proj,layers.57.self_attn.q_proj,layers.57.self_attn.v_proj,layers.57.self_attn.o_proj,layers.57.mlp.gate_proj,layers.57.mlp.up_proj,layers.57.mlp.down_proj,layers.58.self_attn.k_proj,layers.58.self_attn.q_proj,layers.58.self_attn.v_proj,layers.58.self_attn.o_proj,layers.58.mlp.gate_proj,layers.58.mlp.up_proj,layers.58.mlp.down_proj,layers.59.self_attn.k_proj,layers.59.self_attn.q_proj,layers.59.self_attn.v_proj,layers.59.self_attn.o_proj,layers.59.mlp.gate_proj,layers.59.mlp.up_proj,layers.59.mlp.down_proj,layers.60.self_attn.k_proj,layers.60.self_attn.q_proj,layers.60.self_attn.v_proj,layers.60.self_attn.o_proj,layers.60.mlp.gate_proj,layers.60.mlp.up_proj,layers.60.mlp.down_proj,layers.61.self_attn.k_proj,layers.61.self_attn.q_proj,layers.61.self_attn.v_proj,layers.61.self_attn.o_proj,layers.61.mlp.gate_proj,layers.61.mlp.up_proj,layers.61.mlp.down_proj,layers.62.self_attn.k_proj,layers.62.self_attn.q_proj,layers.62.self_attn.v_proj,layers.62.self_attn.o_proj,layers.62.mlp.gate_proj,layers.62.mlp.up_proj,layers.62.mlp.down_proj,layers.63.self_attn.k_proj,layers.63.self_attn.q_proj,layers.63.self_attn.v_proj,layers.63.self_attn.o_proj,layers.63.mlp.gate_proj,layers.63.mlp.up_proj,layers.63.mlp.down_proj,layers.64.self_attn.k_proj,layers.64.self_attn.q_proj,layers.64.self_attn.v_proj,layers.64.self_attn.o_proj,layers.64.mlp.gate_proj,layers.64.mlp.up_proj,layers.64.mlp.down_proj,layers.65.self_attn.k_proj,layers.65.self_attn.q_proj,layers.65.self_attn.v_proj,layers.65.self_attn.o_proj,layers.65.mlp.gate_proj,layers.65.mlp.up_proj,layers.65.mlp.down_proj,layers.66.self_attn.k_proj,layers.66.self_attn.q_proj,layers.66.self_attn.v_proj,layers.66.self_attn.o_proj,layers.66.mlp.gate_proj,layers.66.mlp.up_proj,layers.66.mlp.down_proj,layers.67.self_attn.k_proj,layers.67.self_attn.q_proj,layers.67.self_attn.v_proj,layers.67.self_attn.o_proj,layers.67.mlp.gate_proj,layers.67.mlp.up_proj,layers.67.mlp.down_proj,layers.68.self_attn.k_proj,layers.68.self_attn.q_proj,layers.68.self_attn.v_proj,layers.68.self_attn.o_proj,layers.68.mlp.gate_proj,layers.68.mlp.up_proj,layers.68.mlp.down_proj,layers.69.self_attn.k_proj,layers.69.self_attn.q_proj,layers.69.self_attn.v_proj,layers.69.self_attn.o_proj,layers.69.mlp.gate_proj,layers.69.mlp.up_proj,layers.69.mlp.down_proj,layers.70.self_attn.k_proj,layers.70.self_attn.q_proj,layers.70.self_attn.v_proj,layers.70.self_attn.o_proj,layers.70.mlp.gate_proj,layers.70.mlp.up_proj,layers.70.mlp.down_proj,layers.71.self_attn.k_proj,layers.71.self_attn.q_proj,layers.71.self_attn.v_proj,layers.71.self_attn.o_proj,layers.71.mlp.gate_proj,layers.71.mlp.up_proj,layers.71.mlp.down_proj,layers.72.self_attn.k_proj,layers.72.self_attn.q_proj,layers.72.self_attn.v_proj,layers.72.self_attn.o_proj,layers.72.mlp.gate_proj,layers.72.mlp.up_proj,layers.72.mlp.down_proj,layers.73.self_attn.k_proj,layers.73.self_attn.q_proj,layers.73.self_attn.v_proj,layers.73.self_attn.o_proj,layers.73.mlp.gate_proj,layers.73.mlp.up_proj,layers.73.mlp.down_proj,layers.74.self_attn.k_proj,layers.74.self_attn.q_proj,layers.74.self_attn.v_proj,layers.74.self_attn.o_proj,layers.74.mlp.gate_proj,layers.74.mlp.up_proj,layers.74.mlp.down_proj,layers.75.self_attn.k_proj,layers.75.self_attn.q_proj,layers.75.self_attn.v_proj,layers.75.self_attn.o_proj,layers.75.mlp.gate_proj,layers.75.mlp.up_proj,layers.75.mlp.down_proj,layers.76.self_attn.k_proj,layers.76.self_attn.q_proj,layers.76.self_attn.v_proj,layers.76.self_attn.o_proj,layers.76.mlp.gate_proj,layers.76.mlp.up_proj,layers.76.mlp.down_proj,layers.77.self_attn.k_proj,layers.77.self_attn.q_proj,layers.77.self_attn.v_proj,layers.77.self_attn.o_proj,layers.77.mlp.gate_proj,layers.77.mlp.up_proj,layers.77.mlp.down_proj,layers.78.self_attn.k_proj,layers.78.self_attn.q_proj,layers.78.self_attn.v_proj,layers.78.self_attn.o_proj,layers.78.mlp.gate_proj,layers.78.mlp.up_proj,layers.78.mlp.down_proj,layers.79.self_attn.k_proj,layers.79.self_attn.q_proj,layers.79.self_attn.v_proj,layers.79.self_attn.o_proj,layers.79.mlp.gate_proj,layers.79.mlp.up_proj,layers.79.mlp.down_proj
lora_rank: 96
lora_alpha: 16
lora_dropout: 0.05
pref_beta: 2
simpo_gamma: 1.0
pref_loss: simpo  # [sigmoid (dpo), orpo, simpo]

### ddp
ddp_timeout: 180000000
# deepspeed: examples/deepspeed/ds_z3_config.json

### dataset
dataset: ultraFeedBack
template: llama2
cutoff_len: 512
max_samples: 100000000
overwrite_cache: false
preprocessing_num_workers: 8

### output /gemini/data-2/mix-ckpt-70b/cust/math
output_dir: /gemini/data-1/LLaMA-Factory-main/lora_merges/qlora/EX-Priv/llama70-alignment-Ex-Priv
logging_steps: 10
save_steps: 1000
plot_loss: true
overwrite_output_dir: true
report_to: wandb
run_name: Llama2-alignment-Cust-lora-Ex-Priv # 可选

### train
per_device_train_batch_size: 4
gradient_accumulation_steps: 4
learning_rate: 1.0e-6
num_train_epochs: 1
lr_scheduler_type: cosine
warmup_ratio: 0.03
bf16: true

### eval
val_size: 0.08
per_device_eval_batch_size: 8
eval_strategy: steps
eval_steps: 1000
